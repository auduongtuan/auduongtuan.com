import type { NextPage } from 'next'
import Head from 'next/head'
import Image from 'next/image'
import { Client } from "@notionhq/client"



const Home: NextPage = ({posts}) => {
  return (
    <div>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" /> 
      </Head>
      {/* {console.log(posts)} */}
  
      <main className='max-w-[640px] mx-auto my-10'>
        <h1 className="text-5xl font-bold">
          Tuan Homepage
        </h1>
        {posts.map(post =>
        <div key={post.id} className="mt-10 border-2 p-10 rounded-md border-gray-100">
          <h4 className="font-bold text-2xl">{(post.properties.Name.title[0].plain_text)}</h4>
          <p className="mt-2">{post.properties.Description.rich_text[0].plain_text}</p>
        </div>)}
        <div className='mt-10'>
          Powered by{' '}
          <span>
            <Image src="/vercel.svg" alt="Vercel Logo" width={72} height={16} />
          </span>
        </div>
      </main>
    </div>
  )
}

export async function getStaticProps() {
  const notion = new Client({ auth: process.env.NOTION_KEY })

  const databaseId = process.env.NOTION_DATABASE_ID || ''
  const myPage = await notion.databases.query({
    database_id: databaseId
  })
  
  // try {
  //   const response = await notion.pages.create({
  //     parent: { database_id: databaseId },
  //     properties: {
  //       title: { 
  //         title:[
  //           {
  //             "text": {
  //               "content": text
  //             }
  //           }
  //         ]
  //       }
  //     },
  //   })
  //   console.log(response)
  //   console.log("Success! Entry added.")
  // } catch (error) {
  //   if(error) console.error(error.body)
  // }
  return {props: {posts: myPage.results}};
}

export default Home
